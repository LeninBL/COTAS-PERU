<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestión de Productos</title>
    <link rel="stylesheet" href="/static/css/style_welcome.css" />
    <link rel="stylesheet" href="/static/css/style_products.css" />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <aside class="sidebar">
        <nav class="navbar">
            <span class="nav-item">
                <i class="fas fa-user"></i> {{ username }}
            </span>
            <a href="/productos-ui" class="nav-item">Gestión de Productos</a>
            <a href="/entradas-ui" class="nav-item">Registro de Entradas</a>
            <a href="/salidas-ui" class="nav-item active">Registro de Salidas</a>
            <a href="/users/me/profile" class="nav-item">Información Personal</a>
            <a href="/users/me/show" class="nav-item">Mostrar Usuarios</a>
            <a href="/users/me/register_show" class="nav-item">Registrar Nuevo Usuario</a>
            <form id="logout" class="logout">
                <button class="button_logout" type="submit">Cerrar sesión</button>
            </form>
        </nav>
    </aside>

    <div class="main-content">
      <div class="welcome-container">
        <h2>Gestión de Productos</h2>
        <h1>Lista de Productos</h1>

        <div class="product-actions">
          <button id="newProductBtn" class="btn-primary">Nuevo Producto</button>
          <div class="search-filter">
            <input
              type="text"
              id="productSearch"
              placeholder="Buscar producto..."
            />
            <select id="categoryFilter">
              <option value="">Todas las categorías</option>
              <!-- Las categorías se cargarán dinámicamente -->
            </select>
            <select id="locationFilter">
              <option value="">Todas las ubicaciones</option>
              <!-- Las ubicaciones se cargarán dinámicamente -->
            </select>
            <button id="clearFilters" class="btn-secondary">Limpiar</button>
          </div>
        </div>

        <div class="table-container">
          <table id="productsTable" class="products-table">
            <thead>
              <tr>
                <th data-sort="codigo">Código <i class="fas fa-sort"></i></th>
                <th data-sort="ubicacion">
                  Ubicación <i class="fas fa-sort"></i>
                </th>
                <th data-sort="categoria">
                  Categoría <i class="fas fa-sort"></i>
                </th>
                <th data-sort="descripcion">
                  Descripción <i class="fas fa-sort"></i>
                </th>
                <th data-sort="marca">Marca <i class="fas fa-sort"></i></th>
                <th data-sort="modelo">Modelo <i class="fas fa-sort"></i></th>
                <th>Estado</th>
                <th data-sort="cantidad_total">
                  Cantidad <i class="fas fa-sort"></i>
                </th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              <!-- Los productos se cargarán dinámicamente -->
            </tbody>
          </table>
          <div class="pagination">
            <button id="prevPage" disabled>Anterior</button>
            <span id="pageInfo">Página 1 de 1</span>
            <button id="nextPage" disabled>Siguiente</button>
            <button id="exportExcel" class="btn-secondary">
              Exportar a Excel
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal para formulario de producto -->
    <div id="productModal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h2 id="modalTitle">Nuevo Producto</h2>
        <form id="productForm">
          <input type="hidden" id="productId" />
          <div class="form-group">
            <label for="codigo">Código*</label>
            <input type="text" id="codigo" required />
            <small class="error-message" id="codigoError"></small>
          </div>
          <div class="form-group">
            <label for="nombre">Nombre*</label>
            <input type="text" id="nombre" required />
            <small class="error-message" id="nombreError"></small>
          </div>
          <div class="form-group">
            <label for="descripcion">Descripción</label>
            <textarea id="descripcion" rows="3"></textarea>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="categoria">Categoría</label>
              <select id="categoria">
                <option value="">Seleccione una categoría</option>
                <!-- Las categorías se cargarán dinámicamente -->
                <option value="_nueva_categoria_">+ Nueva categoría</option>
              </select>
            </div>
            <div class="form-group">
              <label for="marca">Marca</label>
              <input type="text" id="marca" />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="modelo">Modelo</label>
              <input type="text" id="modelo" />
            </div>
            <div class="form-group">
              <label for="ubicacion">Ubicación*</label>
              <select id="ubicacion" required>
                <option value="">Seleccione una ubicación</option>
                <!-- Las ubicaciones se cargarán dinámicamente -->
              </select>
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="cantidad_total">Cantidad Total*</label>
              <input type="number" id="cantidad_total" min="0" required />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="cantidad_nuevos">Nuevos</label>
              <input type="number" id="cantidad_nuevos" min="0" value="0" />
            </div>
            <div class="form-group">
              <label for="cantidad_usados">Usados</label>
              <input type="number" id="cantidad_usados" min="0" value="0" />
            </div>
            <div class="form-group">
              <label for="cantidad_danados">Dañados</label>
              <input type="number" id="cantidad_danados" min="0" value="0" />
            </div>
          </div>
          <div class="form-actions">
            <button type="button" id="cancelBtn" class="btn-secondary">
              Cancelar
            </button>
            <button type="submit" id="saveBtn" class="btn-primary">
              Guardar
            </button>
          </div>
        </form>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="/static/js/script_welcome.js"></script>
    <script src="/static/js/products.js"></script>
  </body>
</html>